<query-editor-row query-ctrl="ctrl" can-collapse="false" has-text-edit-mode="true">
    <div class="gf-form-group">
        <div class="gf-form-inline">
            <div class="gf-form" ng-if="!ctrl.target.rawQuery">
                <label class="gf-form-label">Metric</label>
                <gf-form-dropdown model="ctrl.target.metric"
                                  allow-custom="true"
                                  lookup-text="true"
                                  get-options="ctrl.getOptions($query)"
                                  on-change="ctrl.onChangeInternal()">
                </gf-form-dropdown>
            </div>
            <div class="gf-form" ng-if="ctrl.target.rawQuery">
                <label class="gf-form-label">Metric</label>
                <textarea class="gf-form-input" rows="5" ng-model="ctrl.target.metric" spellcheck="false"
                          ng-blur="ctrl.onChangeInternal()"/>
            </div>
        </div>
        <div class="gf-form-inline">
          <div class="gf-form">
            <label class="gf-form-label">Name</label>
            <input type="text" class="gf-form-input" ng-model="ctrl.target.name"
                   data-placement="right" spellcheck='false' placeholder="$metric/$function"
                   ng-blur="ctrl.onChangeInternal()">
          </div>
        </div>
        <div class="gf-form-inline">
            <div class="gf-form">
                <label class="gf-form-label">Functions</label>
                <value-select-dropdown dashboard="ctrl.dummydashboard" variable="ctrl.selected_aggregates" on-updated="ctrl.aggregatesUpdated()" />
            </div>
          <div class="gf-form">
                <input type="text" class="gf-form-input" ng-model="ctrl.target.smaWindow"
                       data-placement="right" spellcheck='false' placeholder="sma window in ms"
                       ng-blur="ctrl.onChangeInternal()"
                       ng-if="ctrl.isSmaSelected()">
            </div>
        </div>
    </div>
</query-editor-row>
