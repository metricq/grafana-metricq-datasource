<query-editor-row query-ctrl="ctrl" can-collapse="false" has-text-edit-mode="true">
    <div class="gf-form-group">
        <div class="gf-form-inline">
            <div class="gf-form">
                <label class="gf-form-label">Metric</label>
                <gf-form-dropdown model="ctrl.target.metric"
                                  allow-custom="true"
                                  lookup-text="true"
                                  get-options="ctrl.getOptions($query)"
                                  on-change="ctrl.onChangeInternal()">
                </gf-form-dropdown>
            </div>
            <div class="gf-form">
                <div class="gf-form-hint-text">Start typing to search for available metrics (dropdown shows first 100 results)</div>
            </div>
        </div>
        <div class="gf-form-inline">
          <div class="gf-form">
            <label class="gf-form-label">Name</label>
            <input type="text" class="gf-form-input" ng-model="ctrl.target.name"
                   data-placement="right" spellcheck='false' placeholder="$metric/$function"
                   ng-blur="ctrl.onChangeInternal()">
          </div>
        </div>
        <div class="gf-form-inline">
            <div class="gf-form">
                <label class="gf-form-label">Functions</label>
              <div class="gf-form-checkbox" ng-click="ctrl.min_selected = !ctrl.min_selected; ctrl.onChangeInternal()">
                <input id="check-min-{{ctrl.id}}" type="checkbox" ng-model="ctrl.min_selected" ng-change="ctrl.onChangeInternal()">
                <span class="gf-form-switch__checkbox"></span>
                <label>min</label>
              </div>
              <div class="gf-form-checkbox" ng-click="ctrl.max_selected = !ctrl.max_selected; ctrl.onChangeInternal()">
                <input id="check-max-{{ctrl.id}}" type="checkbox" ng-model="ctrl.max_selected" ng-change="ctrl.onChangeInternal()">
                <span class="gf-form-switch__checkbox"></span>
                <label>max</label>
              </div>
              <div class="gf-form-checkbox" ng-click="ctrl.avg_selected = !ctrl.avg_selected; ctrl.onChangeInternal()">
                <input id="check-avg-{{ctrl.id}}" type="checkbox" ng-model="ctrl.avg_selected" ng-change="ctrl.onChangeInternal()">
                <span class="gf-form-switch__checkbox"></span>
                <label>avg</label>
              </div>
              <div class="gf-form-checkbox" ng-click="ctrl.count_selected = !ctrl.count_selected; ctrl.onChangeInternal()">
                <input id="check-count-{{ctrl.id}}" type="checkbox" ng-model="ctrl.count_selected" ng-change="ctrl.onChangeInternal()">
                <span class="gf-form-switch__checkbox"></span>
                <label>count</label>
              </div>
              <div class="gf-form-checkbox" ng-click="ctrl.sma_selected = !ctrl.sma_selected; ctrl.onChangeInternal()">
                <input id="check-sma-{{ctrl.id}}" type="checkbox" ng-model="ctrl.sma_selected" ng-change="ctrl.onChangeInternal()">
                <span class="gf-form-switch__checkbox"></span>
                <label>sma</label>
              </div>
            </div>
          <div class="gf-form">
                <input type="text" class="gf-form-input" ng-model="ctrl.target.smaWindow"
                       data-placement="right" spellcheck='false' placeholder="sma window in ms"
                       ng-blur="ctrl.onChangeInternal()"
                       ng-if="ctrl.isSmaSelected()">
            </div>
        </div>
        <div class="gf-form-inline">
          <div class="gf-form">
            <label class="gf-form-label">Scaling factor</label>
            <input type="text" class="gf-form-input" ng-model="ctrl.target.scalingFactor"
                   data-placement="right" spellcheck='false'
                   ng-blur="ctrl.onChangeInternal()">
          </div>
        </div>
    </div>
</query-editor-row>
